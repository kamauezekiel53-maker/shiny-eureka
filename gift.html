<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Made with love and stars ‚ú®</title>
  <style>
    :root {
      --bg1: #0b0f1a; --bg2: #121729; --text: #e9ecf5; --muted: #a9b3c9;
      --accent1: #ff8ea8; --accent2: #9b5cff; --accent3: #ffd56b;
      --panel: rgba(10,14,26,0.55); --border: rgba(255,255,255,0.12);
      --shadow: 0 20px 40px rgba(0,0,0,0.4);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      color: var(--text); background:
        radial-gradient(1200px 600px at 80% -10%, rgba(255, 141, 168, 0.16) 0%, transparent 60%),
        radial-gradient(1000px 700px at -10% 110%, rgba(155, 92, 255, 0.12) 0%, transparent 60%),
        linear-gradient(180deg, #0b0f1a, #0d1323 50%, #0b0f1a 100%);
      min-height: 100vh; display: grid; place-items: center; padding: 22px;
    }
    .wrap { width: 100%; max-width: 640px; }
    .panel {
      background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.01));
      border: 1px solid var(--border); border-radius: 20px; box-shadow: var(--shadow); backdrop-filter: blur(8px);
      overflow: hidden;
    }
    .hero {
      position: relative; padding: 26px 22px 18px; background:
        linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.00)),
        url('https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?q=80&w=1600&auto=format&fit=crop') center/cover no-repeat;
      min-height: 160px;
    }
    .overlay { position: absolute; inset: 0; background: linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.45)); }
    .quote {
      position: relative; z-index: 1; font-size: 1.1rem; font-weight: 600; text-shadow: 0 2px 12px rgba(0,0,0,0.45);
    }
    .name {
      position: relative; z-index: 1; margin-top: 8px; color: #ffd9e7; font-weight: 700;
    }
    .content { padding: 18px 18px 6px; }
    .poem {
      background: rgba(9, 13, 24, 0.55); border: 1px solid var(--border); border-radius: 14px; padding: 16px;
    }
    .poem h2 { margin: 0 0 10px; font-size: 1.25rem; }
    .poem p { margin: 7px 0; line-height: 1.55; }
    .controls { display: flex; gap: 10px; margin-top: 12px; }
    .btn {
      border: 1px solid var(--border); background: rgba(255,255,255,0.05);
      color: var(--text); padding: 10px 12px; border-radius: 12px; cursor: pointer; font-weight: 700;
    }
    .btn.primary { border-color: rgba(155,92,255,0.35); background: rgba(155,92,255,0.15); }
    .video {
      margin-top: 14px; border-radius: 14px; overflow: hidden; border: 1px solid var(--border);
    }
    .footer {
      padding: 12px 18px 18px; display: flex; justify-content: space-between; align-items: center; color: var(--muted);
    }
    .brand { font-size: 0.9rem; }
    .wa { text-decoration: none; font-weight: 700; color: #25D366; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="panel">
      <div class="hero">
        <div class="overlay"></div>
        <div class="quote" id="quote">‚ÄúI've smiled at lips I didn't miss.‚Äù</div>
        <div class="name" id="name"></div>
      </div>

      <div class="content">
        <div class="poem">
          <h2 id="title">Her Light</h2>
          <div id="poem">
            <p>She walks like dawn ‚Äî</p>
            <p>soft, certain,</p>
            <p>impossible to ignore.</p>
            <p>Even the night</p>
            <p>stays a little longer</p>
            <p>just to see her rise.</p>
          </div>

          <div class="controls">
            <button class="btn" id="back">Back</button>
            <button class="btn primary" id="pause">Pause</button>
            <button class="btn" id="next">Next</button>
          </div>
        </div>

        <div class="video" id="videoBox" style="display:none;">
          <iframe id="ytFrame" width="100%" height="208" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
        </div>

        <div class="poem" style="margin-top:14px;">
          <h2>Final Message</h2>
          <div id="final">
            <p>This is not about us.</p>
            <p>It is about you ‚Äî</p>
            <p>the way you turn ordinary moments</p>
            <p>into constellations.</p>
            <p>I will always look up</p>
            <p>and find you there.</p>
            <p>‚Äî Created with love</p>
          </div>
          <div class="controls">
            <a id="waLink" class="btn primary" href="#" target="_blank">Send reaction on WhatsApp</a>
            <button class="btn" id="restart">Restart</button>
          </div>
        </div>
      </div>

      <div class="footer">
        <div class="brand">Made with love and stars ‚Ä¢ <span id="by">Someone</span></div>
        <div><small id="friendSmall"></small></div>
      </div>
    </div>
  </div>

  <script>
    // Read parameters
    const q = new URLSearchParams(window.location.search);
    const sender = q.get('s') || 'Someone';
    const friend = q.get('f') || '';
    const yt = q.get('yt') || '';
    const auto = q.get('auto') === '1';
    const wa = q.get('wa') || '';
    const token = q.get('t') || '';

    // Personalize text
    document.getElementById('by').textContent = sender;
    document.getElementById('name').textContent = friend ? `For ${friend}` : '';
    document.getElementById('friendSmall').textContent = friend ? `${friend} ‚ú®` : '';

    // Poems (slideshow)
    const poems = [
      {
        title: 'Her Light',
        lines: [
          'She walks like dawn ‚Äî',
          'soft, certain,',
          'impossible to ignore.',
          'Even the night',
          'stays a little longer',
          'just to see her rise.'
        ],
        quote: "I've smiled at lips I didn't miss."
      },
      {
        title: 'Quiet Constellations',
        lines: [
          'In the hush between our words,',
          'stars learn your name.',
          'Every breath you take',
          'maps a gentle sky',
          'where small joys orbit,',
          'warm and unafraid.'
        ],
        quote: 'I keep my promises where your light can find them.'
      },
      {
        title: 'Ways of Morning',
        lines: [
          'You turn tea into ceremony,',
          'rain into chorus,',
          'Sundays into soft lanterns',
          'hanging from the heart.',
          'The world gets tender',
          'when you arrive.'
        ],
        quote: 'Some doors open only when your laughter knocks.'
      },
      {
        title: 'Final Message',
        lines: [
          'This is not about us.',
          'It is about you ‚Äî',
          'the way you turn ordinary moments',
          'into constellations.',
          'I will always look up',
          'and find you there.',
          '‚Äî Created with love'
        ],
        quote: 'The sky remembers you.'
      }
    ];

    let idx = 0, playing = true, timer = null;

    function renderPoem(i) {
      const p = poems[i];
      document.getElementById('title').textContent = p.title;
      document.getElementById('quote').textContent = `‚Äú${p.quote}‚Äù`;
      const box = document.getElementById('poem');
      box.innerHTML = '';
      p.lines.forEach(line => {
        const el = document.createElement('p'); el.textContent = line; box.appendChild(el);
      });
    }

    function nextPoem() { idx = (idx + 1) % (poems.length - 1); renderPoem(idx); }
    function prevPoem() { idx = (idx - 1 + (poems.length - 1)) % (poems.length - 1); renderPoem(idx); }

    function startAuto() {
      stopAuto();
      timer = setInterval(nextPoem, 4000);
      playing = true; document.getElementById('pause').textContent = 'Pause';
    }
    function stopAuto() {
      if (timer) clearInterval(timer);
      timer = null; playing = false; document.getElementById('pause').textContent = 'Play';
    }

    document.getElementById('next').addEventListener('click', nextPoem);
    document.getElementById('back').addEventListener('click', prevPoem);
    document.getElementById('pause').addEventListener('click', () => playing ? stopAuto() : startAuto());
    document.getElementById('restart').addEventListener('click', () => { idx = 0; renderPoem(idx); });

    // Initialize
    renderPoem(idx);
    startAuto();

    // WhatsApp reaction link
    const waBtn = document.getElementById('waLink');
    if (wa) {
      const text = encodeURIComponent(`Hi ${sender}, I just read the poem page. It was beautiful. Thank you! ${token ? '‚Ä¢ ' + token : ''}`);
      waBtn.href = `https://wa.me/${wa}?text=${text}`;
    } else {
      waBtn.textContent = 'Share a reaction';
      waBtn.href = `https://wa.me/?text=${encodeURIComponent('This page made me smile üòä')}`;
    }

    // Optional YouTube
    if (yt) {
      const box = document.getElementById('videoBox');
      const frame = document.getElementById('ytFrame');
      const url = new URL(yt, window.location.href);
      // Convert common YouTube formats to embed
      let vid = '';
      if (url.hostname.includes('youtu.be')) {
        vid = url.pathname.slice(1);
      } else if (url.hostname.includes('youtube.com')) {
        vid = (new URLSearchParams(url.search)).get('v') || '';
      }
      const base = vid ? `https://www.youtube.com/embed/${vid}` : yt;
      const qp = new URLSearchParams({ autoplay: auto ? '1' : '0', rel: '0', modestbranding: '1' });
      frame.src = `${base}?${qp.toString()}`;
      box.style.display = 'block';
    }
  </script>
</body>
  </html>
